---
layout: post
title: "Deploying What's Up Docker (WUD) with Agents on Multiple Docker Hosts"
author: krzysiek
categories: [proxmox, linux, docker]
image: "https://getwud.github.io/wud/assets/wud-arch.png"
featured: true
hidden: false
---

Monitoring container updates across multiple Docker hosts can be a challenge. 
Fortunately, [What's Up Docker (WUD)](https://github.com/fmartinou/whats-up-docker) offers a clean solution through its agent-based architecture. 
In this guide, you'll learn how to set up a central WUD server with agents running on other Docker hosts.

---

## Requirements

* Docker installed on all hosts
* Network connectivity between all hosts (e.g., local LAN or VPN)
* Open port `3000` on the central WUD host for agents to connect

---

## 1. Set Up the Main WUD Server (Master)

On your main monitoring host (e.g., `192.168.69.100`):

### `docker-compose.yml`

```yaml
version: "3.8"

services:
  wud:
    image: ghcr.io/getwud/wud
    container_name: wud
    restart: always
    ports:
      - 3000:3000
    environment:
      - WUD_WATCHER_LOCAL_TYPE=socket
      - WUD_WATCHER_LOCAL_SOCKET=/var/run/docker.sock
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
```

### Start the service

```bash
docker compose up -d
```

### Access the Web UI

Open `http://192.168.69.100:3000` in your browser to see the WUD interface.

---

## 2. Set Up WUD Agent on Remote Docker Hosts

Repeat this on each remote host (e.g., `192.168.69.249`, `192.168.69.251`):

### `docker-compose.yml`

```yaml
version: "3.8"

services:
  wud-agent:
    image: ghcr.io/getwud/wud
    container_name: wud-agent
    restart: always
    environment:
      - WUD_MODE=agent
      - WUD_AGENT_MASTER_URL=http://192.168.69.100:3000
      - WUD_WATCHER_LOCAL_TYPE=socket
      - WUD_WATCHER_LOCAL_SOCKET=/var/run/docker.sock
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
```

Replace `192.168.69.100` with the IP address of your master WUD server.

### Start the agent

```bash
docker compose up -d
```

WUD will automatically detect and register the agent.

---

## 3. Verify Everything is Working

Go back to `http://192.168.69.100:3000` and check that all remote hosts appear as watchers. You should see:

* `local` (master host)
* `agent-xxx` (one for each remote agent)

---

## 4. Optional: Secure Communication

### Option A: Use VPN (Tailscale, WireGuard)

* Set up VPN between all hosts
* Use VPN IPs (e.g., `100.x.x.x`) in `WUD_AGENT_MASTER_URL`

### Option B: Use HTTPS with a Reverse Proxy

* Deploy Nginx or Traefik with TLS on the master host
* Expose WUD at `https://your-domain`
* Update agents to use `https://...` URL

---

## 5. Maintenance Tips

### Restart WUD or agents

```bash
docker compose down && docker compose up -d
```

### Update WUD or agents

```bash
docker compose pull && docker compose up -d
```

---

## Host Overview

| Host IP        || Role       || Container   |
| -------------- || ---------- || ----------- |
| 192.168.69.100 || WUD Master || `wud`       |
| 192.168.69.249 || WUD Agent  || `wud-agent` |
| 192.168.69.251 || WUD Agent  || `wud-agent` |

---

With this setup, WUD gives you a centralized, agent-based view of Docker container updates across your homelab or infrastructure. Happy monitoring! ðŸš€
